<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><title>CETS Admin Dashboard</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap"><style>
body{margin:0;font-family:"Inter",sans-serif;background:#f3f4f6;overflow:hidden}.container{display:flex;height:100vh;width:100vw}.sidebar{width:260px;background:#111827;color:#fff;padding:24px 18px;display:flex;flex-direction:column}.sidebar .logoBox{text-align:center;margin-bottom:28px}.sidebar img{width:160px;max-width:90%}.menuItem{padding:12px 14px;color:#e5e7eb;font-weight:600;border-radius:8px;cursor:pointer;margin-bottom:8px}.menuItem:hover{background:#1f2937}.menuItem.active{background:#2563eb;color:#fff}.main{flex:1;background:#f9fafb;padding:22px;overflow-y:auto}.header{font-size:22px;font-weight:900;margin-bottom:22px}.calendarGrid{display:grid;grid-template-columns:repeat(7,1fr);gap:12px}.dayCell{background:#fff;border-radius:12px;padding:12px;min-height:100px;cursor:pointer;border:1px solid #e5e7eb;transition:.2s}.dayCell:hover{box-shadow:0 4px 14px rgba(0,0,0,.1)}.dayCell.inactive{opacity:.4}.dayNumber{font-weight:700;font-size:16px}.dot{width:10px;height:10px;border-radius:50%;display:inline-block}.dot.whitehall{background:#2563eb}.dot.reynoldsburg{background:#7c3aed}.dot.livingston{background:#16a34a}.dot.groveport{background:#ea580c}.dot.online{background:#0d9488}.dot.audit{background:#b91c1c}.drawer{position:fixed;top:0;right:-420px;width:420px;height:100vh;background:#fff;border-left:1px solid #e5e7eb;padding:22px;box-shadow:-4px 0 14px rgba(0,0,0,.1);overflow-y:auto;transition:.35s}.drawer.open{right:0}.drawer h2{font-size:20px;font-weight:900}.closeBtn{background:#ef4444;color:#fff;border:none;padding:8px 14px;border-radius:8px;float:right;cursor:pointer}input,select{width:100%;padding:12px;border-radius:10px;border:1px solid #d1d5db;margin-top:8px;margin-bottom:16px}label{font-size:14px;font-weight:700}.btnSave{background:#2563eb;color:#fff;padding:14px;width:100%;border:none;border-radius:10px;font-size:16px;font-weight:700;cursor:pointer;margin-top:12px}.btnDelete{background:#dc2626;color:#fff;padding:14px;width:100%;border:none;border-radius:10px;font-size:16px;font-weight:700;cursor:pointer;margin-top:12px}
</style></head><body>

<div class="container">
<div class="sidebar">
<div class="logoBox"><img src="https://raw.githubusercontent.com/sinyalfa/CETS/main/logo1.png"/></div>
<div class="menuItem active">Dashboard</div>
<div class="menuItem">Calendar</div>
<div class="menuItem">Appointments</div>
<div class="menuItem">Locations</div>
<div class="menuItem" id="logoutBtn">Logout</div>
</div>

<div class="main">
<div class="header" id="monthLabel">Loading Calendarâ€¦</div>
<div class="calendarGrid" id="calendarGrid"></div>
</div>
</div>

<div class="drawer" id="drawer">
<button class="closeBtn" onclick="closeDrawer()">Close</button>
<h2>Appointment Details</h2>

<label>Date</label>
<input type="date" id="editDate">

<label>Time</label>
<select id="editTime"></select>

<label>Status</label>
<select id="editStatus"><option value="confirmed">Confirmed</option><option value="cancelled">Cancelled</option></select>

<button class="btnSave" onclick="saveChanges()">Save Changes</button>
<button class="btnDelete" onclick="deleteAppointment()">Delete Appointment</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabaseUrl="https://zleztbdrxnqirccgkvqx.supabase.co",supabaseKey="sb_publishable_pXXUCH_hx0eg7tUbQNz3rw_DaJgACMR",supa=supabase.createClient(supabaseUrl,supabaseKey);let currentMonth=new Date,appointments=[],selectedAppt=null;

async function loadAppointments(){const{data}=await supa.from("appointments").select("*");appointments=data||[];renderCalendar()}
function renderCalendar(){const grid=document.getElementById("calendarGrid");grid.innerHTML="";const year=currentMonth.getFullYear(),month=currentMonth.getMonth();document.getElementById("monthLabel").textContent=currentMonth.toLocaleString("default",{month:"long"})+" "+year;const firstDay=new Date(year,month,1).getDay(),daysInMonth=new Date(year,month+1,0).getDate();for(let i=0;i<firstDay;i++){let c=document.createElement("div");c.classList.add("dayCell","inactive");grid.appendChild(c)}
for(let d=1;d<=daysInMonth;d++){let c=document.createElement("div");c.classList.add("dayCell");let dateStr=`${year}-${String(month+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`,daily=appointments.filter(a=>a.start_time.startsWith(dateStr));c.innerHTML=`<div class='dayNumber'>${d}</div>`;daily.forEach(a=>{let dot=document.createElement("span");dot.classList.add("dot");let loc=a.location.toLowerCase();if(loc.includes("whitehall"))dot.classList.add("whitehall");else if(loc.includes("reynoldsburg"))dot.classList.add("reynoldsburg");else if(loc.includes("livingston"))dot.classList.add("livingston");else if(loc.includes("groveport"))dot.classList.add("groveport");else if(loc.includes("online"))dot.classList.add("online");else if(loc.includes("audit"))dot.classList.add("audit");c.appendChild(dot);c.onclick=()=>openDrawer(a)});grid.appendChild(c)}}

function openDrawer(a){selectedAppt=a;document.getElementById("editDate").value=a.start_time.split("T")[0];let t=document.getElementById("editTime");t.innerHTML="";["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00"].forEach(s=>{let o=document.createElement("option");o.value=s;o.textContent=s;if(a.start_time.includes(s))o.selected=true;t.appendChild(o)});document.getElementById("editStatus").value=a.status;document.getElementById("drawer").classList.add("open")}
function closeDrawer(){document.getElementById("drawer").classList.remove("open")}

async function saveChanges(){let nd=document.getElementById("editDate").value,nt=document.getElementById("editTime").value,ns=document.getElementById("editStatus").value,updatedStart=nd+"T"+nt+":00";await supa.from("appointments").update({start_time:updatedStart,end_time:new Date(new Date(updatedStart).getTime()+3600000).toISOString(),status:ns}).eq("id",selectedAppt.id);closeDrawer();loadAppointments()}

async function deleteAppointment(){if(!confirm("Delete appointment?"))return;await supa.from("appointments").delete().eq("id",selectedAppt.id);closeDrawer();loadAppointments()}

document.getElementById("logoutBtn").onclick=async()=>{await supa.auth.signOut();alert("Logged out");window.location.href="index.html"}

loadAppointments();
</script>
</body></html>
