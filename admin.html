<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Admin Dashboard</title>

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
<script src="https://unpkg.com/@supabase/supabase-js"></script>

<style>
    body {
        background: #f3f4f6;
    }

    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 12px;
    }

    .day-cell {
        background: white;
        border-radius: 12px;
        padding: 18px;
        min-height: 100px;
        font-weight: 600;
        cursor: pointer;
        border: 1px solid #e5e7eb;
    }

    .sidepanel {
        width: 280px;
        background: #0f172a;
        color: white;
        height: 100vh;
        padding: 20px;
    }

    .sidepanel a {
        display: block;
        margin: 14px 0;
        padding: 10px 12px;
        border-radius: 8px;
        text-decoration: none;
        color: white;
        font-size: 16px;
    }

    .sidepanel a:hover {
        background: #1e293b;
    }

    #detailsPanel {
        position: fixed;
        top: 0;
        right: -400px;
        height: 100%;
        width: 400px;
        background: white;
        border-left: 1px solid #ddd;
        padding: 20px;
        transition: 0.3s ease;
        overflow-y: auto;
    }
</style>
</head>

<body class="flex">

<!-- SIDEBAR -->
<div class="sidepanel">
    <img src="https://sinyalfa.github.io/CETS/logo1.png" class="mb-6 w-40">

    <a href="#">Dashboard</a>
    <a href="#">Calendar</a>
    <a href="#">Appointments</a>
    <a href="#">Logout</a>
</div>

<!-- MAIN CONTENT -->
<div class="flex-1 p-10">

    <h1 class="text-3xl font-bold mb-6">Admin Calendar</h1>

    <div id="calendar" class="calendar-grid"></div>
</div>

<!-- DETAILS PANEL -->
<div id="detailsPanel"></div>

<script>
const supabase = supabase.createClient(
    "https://zleztdbrxnqirccgkvqx.supabase.co",
    "YOUR_PUBLIC_ANON_KEY"
);

const calendarEl = document.getElementById("calendar");
const details = document.getElementById("detailsPanel");

// Build month
function buildCalendar() {
    const year = 2026;
    const month = 0; // January

    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const totalDays = lastDay.getDate();

    for (let day = 1; day <= totalDays; day++) {
        const cell = document.createElement("div");
        cell.className = "day-cell";
        cell.textContent = day;

        cell.onclick = () => loadAppointments(year, month + 1, day);

        calendarEl.appendChild(cell);
    }
}

async function loadAppointments(y, m, d) {

    const dateStr = `${y}-${String(m).padStart(2,"0")}-${String(d).padStart(2,"0")}`;

    const { data, error } = await supabase
        .from("appointments")
        .select("*")
        .eq("date", dateStr);

    details.style.right = "0px";
    details.innerHTML = `
        <h2 class="text-xl font-bold mb-4">Appointments for ${dateStr}</h2>
        ${data.map(a => `
            <div class="border p-3 mb-3 rounded">
                <div><b>${a.client_name}</b></div>
                <div>${a.service}</div>
                <div>${a.time}</div>
                <div>${a.location}</div>
            </div>
        `).join("")}
    `;
}

buildCalendar();
</script>

</body>
</html>
